drop table if exists salesman

if object_id(N'salesman','U') is null
create table salesman(
SALESMAN_ID int primary key identity (11,1),
SALESMAN_NAME varchar(30)
)

insert into salesman (SALESMAN_NAME) values
	('Jonathan Goodwin     '),
    ('Adam Hughes          '),
    ('Mark Davenport       '),
    ('Jamie Shelley        '),
    ('Ethan Birkenhead     '),
    ('Liam Alton           '),
    ('Josh Day             '),
    ('Sean Mann            '),
    ('Evan Blake           '),
    ('Rhys Emsworth        '),
    ('Kian Wordsworth      '),
    ('Frederick Kelsey     '),
    ('Noah Turner          '),
    ('Callum Bing          '),
    ('Harri Wilberforce    '),
    ('Gabriel Gibson       '),
    ('Richard York         '),
    ('Tobias Stratford     '),
    ('Will Kirby           '),
    ('Bradley Wright       '),
    ('Eli Willoughby       '),
    ('Patrick Riley        '),
    ('Kieran Freeman       '),
    ('Toby Scott           '),
    ('Elliot Clapham       '),
    ('Lewis Moss           '),
    ('Joshua Atterton      '),
    ('Jonathan Reynolds    '),
    ('David Hill           '),
    ('Aidan Yeardley       '),
    ('Dan Astley           '),
    ('Finlay Dalton        '),
    ('Toby Rodney          '),
    ('Ollie Wheatley       '),
    ('Sean Spalding        '),
    ('Jason Wilson         '),
    ('Christopher Wentworth'),
    ('Cameron Ansley       '),
    ('Henry Porter         '),
    ('Ezra Winterbourne    '),
    ('Rufus Fleming        '),
    ('Wallace Dempsey      '),
    ('Dan McKee            '),
    ('Marion Caldwell      '),
    ('Morris Phillips      '),
    ('Chester Chandler     '),
    ('Cleveland Klein      '),
    ('Hubert Bean          '),
    ('Cleveland Hart       '),
    ('Marion Gregory       ')







drop table if exists sales

if object_id(N'sales','U') is null
create table sales(
	TRANSACTION_ID int primary key identity(501,1),
	SALESMAN_ID int,
	SALE_AMMOUNT decimal(8,2),
	foreign key (SALESMAN_ID) references salesman(SALESMAN_ID)

)

insert into sales (SALESMAN_ID,SALE_AMMOUNT) values
	    (18, 5200.00),
        (50, 5566.00),
        (38, 8400.00),
        (43, 8400.00),
        (11, 9000.00),
        (42, 5900.00),
        (13, 7000.00),
        (33, 6000.00),
        (41, 8200.00),
        (11, 4500.00),
        (51,10000.00),
        (29, 9500.00),
        (59, 6500.00),
        (38, 7800.00),
        (58, 9800.00),
        (60,12000.00),
        (58,13900.00),
        (23,12200.00),
        (34, 5480.00),
        (35, 8129.00),
        (49, 9323.00),
        (46, 8200.00),
        (47, 9990.00),
        (42,14000.00),
        (44, 7890.00),
        (47, 5990.00),
        (21, 7770.00),
        (57, 6645.00),
        (56, 5125.00),
        (25,10990.00),
        (21,12600.00),
        (41, 5514.00),
        (17,15600.00),
        (44,15000.00),
        (12,17550.00),
        (55,13000.00),
        (58,16800.00),
        (25,19900.00),
        (57, 9990.00),
        (28, 8900.00),
        (44,10200.00),
        (57,18000.00),
        (34,16200.00),
        (36,19998.00),
        (30,13500.00),
        (37,15520.00),
        (36,20000.00),
        (20,19800.00),
        (22,18530.00),
        (19,12523.00),
        (46, 9885.00),
        (22, 7100.00),
        (54,17500.00),
        (19,19600.00),
        (24,17500.00),
        (38, 7926.00),
        (49, 7548.00),
        (15, 9778.00),
        (56,19330.00),
        (24,14400.00),
        (18,16700.00),
        (54, 6420.00),
        (31,18720.00),
        (21,17220.00),
        (48,18880.00),
        (33, 8882.00),
        (44,19550.00),
        (22,14440.00),
        (53,19500.00),
        (30, 5300.00),
        (30,10823.00),
        (35,13300.00),
        (35,19100.00),
        (18,17525.00),
        (60, 8995.00),
        (53, 9990.00),
        (21, 7660.00),
        (27,18990.00),
        (11,18200.00),
        (30,12338.00),
        (37,11000.00),
        (27,11980.00),
        (18,12628.00),
        (52,11265.00),
        (53,19990.00),
        (27, 8125.00),
        (25, 7128.00),
        (57, 6760.00),
        (19, 5985.00),
        (52,17641.00),
        (53,11225.00),
        (22,12200.00),
        (59,16520.00),
        (35,19990.00),
        (42,19741.00),
        (19,15000.00),
        (57,19625.00),
        (53, 9825.00),
        (24,16745.00),
        (12,14900.00)



select salesman.SALESMAN_ID,salesman.SALESMAN_NAME,count_transactions.total_transactions,sum_sales.total_sales from 
(select SALESMAN_ID,count(TRANSACTION_ID) as total_transactions from sales group by SALESMAN_ID having count(TRANSACTION_ID)>=5) count_transactions 
join
(select SALESMAN_ID,sum(SALE_AMMOUNT) as total_sales  from sales group by SALESMAN_ID having sum(SALE_AMMOUNT)>=5000) sum_sales
on count_transactions.SALESMAN_ID=sum_sales.SALESMAN_ID
join salesman on salesman.SALESMAN_ID=sum_sales.SALESMAN_ID order by salesman.SALESMAN_ID desc