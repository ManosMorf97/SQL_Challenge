drop table if exists orders

if object_id(N'orders','U') is null
create table orders(
ORDER_ID int primary key identity(101,1),
CUSTOMER_ID int not null,
ITEM_DESC varchar(30) not null,
ORDER_DATE date not null,
order_qty int not null)

insert into orders (CUSTOMER_ID,ITEM_DESC,ORDER_DATE,order_qty) values
	 (2109,'juice     ','2019-07-21',50),
     (2139,'chocolate ','2019-05-17',40),
     (2120,'juice     ','2019-05-17',40),
     (2108,'cookies   ','2019-05-17',50),
     (2130,'juice     ','2019-10-18',45),
     (2103,'cake      ','2019-07-21',35),
     (2122,'cookies   ','2019-12-17',40),
     (2125,'cake      ','2019-12-17',38),
     (2139,'cake      ','2019-07-21',40),
     (2141,'cookies   ','2019-05-17',60),
     (2116,'cake      ','2019-10-18',45),
     (2128,'cake      ','2019-10-18',38),
     (2146,'chocolate ','2019-10-18',55),
     (2119,'cookies   ','2019-10-18',30),
     (2142,'cake      ','2019-03-05',26),
     (2122,'cake      ','2019-03-05',59),
     (2128,'chocolate ','2019-06-19',45),
     (2112,'cookies   ','2019-06-19',28),
     (2149,'cookies   ','2019-10-18',49),
     (2100,'cookies   ','2020-03-14',76),
     (2130,'juice     ','2020-03-14',20),
     (2103,'juice     ','2019-07-21',27),
     (2112,'cookies   ','2019-06-19',52),
     (2102,'cake      ','2019-07-21',14),
     (2120,'chocolate ','2019-07-21',85),
     (2109,'cake      ','2019-06-19',18),
     (2101,'juice     ','2019-10-18',64),
     (2138,'juice     ','2019-06-19',55),
     (2100,'juice     ','2019-07-21',45),
     (2129,'juice     ','2019-10-18',35),
     (2123,'juice     ','2019-10-18',25),
     (2104,'chocolate ','2019-10-18',63),
     (2110,'cake      ','2019-12-17',38),
     (2143,'cake      ','2019-06-19',27),
     (2130,'juice     ','2019-05-17',30),
     (2128,'juice     ','2019-10-18',40),
     (2133,'cookies   ','2019-06-19',51),
     (2150,'cookies   ','2019-06-19',43),
     (2120,'juice     ','2019-10-18',55),
     (2109,'cake      ','2019-10-18',44),
     (2110,'cake      ','2019-12-17',50),
     (2140,'juice     ','2019-03-05',65),
     (2112,'cookies   ','2019-10-18',46),
     (2117,'chocolate ','2019-06-19',25),
     (2137,'cookies   ','2019-07-21',49),
     (2130,'cake      ','2019-12-17',40),
     (2133,'cake      ','2019-07-21',30),
     (2143,'juice     ','2019-03-05',60),
     (2111,'chocolate ','2019-07-21',74),
     (2150,'cookies   ','2019-10-18',75),
     (2131,'cake      ','2019-07-21',45),
     (2140,'chocolate ','2019-05-17',40),
     (2147,'cookies   ','2019-07-21',65),
     (2119,'chocolate ','2019-05-17',60),
     (2116,'juice     ','2019-12-17',40),
     (2141,'juice     ','2019-12-17',50),
     (2143,'cake      ','2019-05-17',55),
     (2105,'cake      ','2019-07-21',70),
     (2149,'chocolate ','2019-03-05',50),
     (2117,'cookies   ','2019-07-21',61),
     (2150,'cookies   ','2019-07-21',50),
     (2134,'cake      ','2019-03-05',55),
     (2133,'cookies   ','2019-06-19',54),
     (2127,'juice     ','2019-06-19',55),
     (2101,'juice     ','2019-06-19',45),
     (2137,'chocolate ','2019-12-17',40),
     (2113,'chocolate ','2019-06-19',30),
     (2141,'cake      ','2019-06-19',60),
     (2112,'chocolate ','2019-12-17',25),
     (2118,'juice     ','2019-10-18',70),
     (2111,'juice     ','2019-06-19',60),
     (2146,'chocolate ','2019-12-17',20),
     (2148,'cookies   ','2020-03-14',55),
     (2100,'cookies   ','2019-12-17',40),
     (2105,'cookies   ','2019-03-05',30),
     (2129,'juice     ','2019-10-18',40),
     (2121,'juice     ','2019-05-17',30),
     (2117,'cake      ','2019-07-21',40),
     (2133,'juice     ','2019-07-21',20),
     (2124,'cake      ','2019-07-21',30),
     (2145,'cake      ','2019-12-17',25),
     (2105,'cookies   ','2019-03-05',20),
     (2131,'juice     ','2019-03-05',50),
     (2114,'chocolate ','2019-10-18',56),
     (2120,'juice     ','2019-12-17',55),
     (2130,'juice     ','2019-12-17',46),
     (2141,'chocolate ','2019-03-05',54),
     (2147,'cake      ','2020-03-14',40),
     (2118,'juice     ','2019-05-17',54),
     (2136,'chocolate ','2019-07-21',58),
     (2132,'cake      ','2019-12-17',50),
     (2137,'chocolate ','2019-07-21',53),
     (2107,'cake      ','2019-10-18',35),
     (2111,'chocolate ','2019-05-17',50),
     (2100,'cake      ','2019-03-05',55),
     (2106,'juice     ','2019-07-21',47),
     (2114,'cookies   ','2019-06-19',55),
     (2110,'cake      ','2019-06-19',75),
     (2130,'juice     ','2019-05-17',55),
     (2117,'cake      ','2019-12-17',48)

with o1 as
(select ITEM_DESC,ORDER_DATE,sum(order_qty) as total_orders from orders where ORDER_DATE between '2019-07-01' and '2019-12-31' group by
ITEM_DESC,ORDER_DATE)
select ITEM_DESC,ORDER_DATE,total_orders from o1 where total_orders=
(select MAX(total_orders) from o1)


